"use strict";(self.webpackChunkimg2go=self.webpackChunkimg2go||[]).push([[8839],{18839:function(e,t,r){r.d(t,{x7:function(){return y},IE:function(){return m}});r(74916),r(15306),r(4723);var n=r(23091),i=r(82017),o=r(72997),a=r(87506),p=(r(69826),r(41539),r(68917)),u=r(56413),l=r(90375);function s(e){this._isValid=!0,this._rawData={},(0,u.dA)(e)?this._rawData=e:this._isValid=!1}s.prototype.isValid=function(){return this._isValid},s.prototype.getId=function(){return(0,n.GY)(this._isValid),this._rawData.id},s.prototype.getSize=function(){return(0,n.GY)(this._isValid),this._rawData.size},s.prototype.getStatus=function(){return(0,n.GY)(this._isValid),(0,i.cV)(this._rawData.status),this._rawData.status},s.prototype.isFinished=function(){return(0,n.GY)(this._isValid),this._rawData.status===l.dp};r(47941);function d(e){if(!(0,o.Rb)(e))return e;try{var t=JSON.parse(e);if((0,o.jV)(t))return a.P.log("qgApiHelper server response was fixed",JSON.stringify(e)),t}catch(e){}return a.P.log("qgApiHelper server response was not fixed",JSON.stringify(e)),e}var f=r(74336),c=r(38232),g=r(19755);function h(e){var t=null;try{t=e.responseText,e.responseJSON&&(t=e.responseJSON)}catch(e){}return t}function v(e,t){this.api=e,this.baseUrlApi=c.f.getApiUrl(),(0,o.Rt)(t.baseUrlApi)&&(this.baseUrlApi=t.baseUrlApi)}v.prototype.createJob=function(e){var t=this.api;(0,o.jV)(e)||(e={});var r=g.extend({},t.baseAjaxOptions);r.url=this.baseUrlApi+"/api/jobs?async=true",r.data=e;var n=g.Deferred(),i=this;return t.ajaxWrapper.postJson(r).done((function(e,r,o){e=d(e),i.getJobInfoUntilStatus(e.sat.id_job,"incomplete",10,!0).done((function(r){var i=new p.S(r);if(!i.isValid())return a.P.log("qgApiHelper createJob fail broken response",{info:"response: "+JSON.stringify(e)}),void n.reject(f.FK);var o=r,u=i.getId();t.jobCache.setData(u,o),a.P.addLogData("job_id",u),a.P.log("qgApiHelper createJob done"),n.resolve(o)})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper createJob fail - payment required"),void n.reject(f.lV,t);n.reject(f.QG)}))})).fail((function(e,t,r){if(402===e.status)return a.P.log("qgApiHelper createJob fail - payment required"),void n.reject(f.lV,h(e));n.reject(f.QG)})),n},v.prototype.getJobInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,n.A2)(e);var i=this.api,o=g.Deferred(),p=g.extend({},i.baseAjaxOptions);p.url=this.baseUrlApi+"/api/jobs/"+e,!0===t&&!1===r&&(p.url+="?async=true"),!0===r&&(p.url+="?sync=true"),i.numberOfCurrentJobInfoRequests.hasOwnProperty(e)||(i.numberOfCurrentJobInfoRequests[e]=0),i.numberOfCurrentJobInfoRequests[e]++;return i.ajaxWrapper.get(p).done((function(t,r,n){i.numberOfCurrentJobInfoRequests[e]--;var a=t=d(t);i.jobCache.setData(e,a),o.resolve(a)})).fail((function(t,r,n){return i.numberOfCurrentJobInfoRequests[e]--,402===t.status?(a.P.log("qgApiHelper getJobInfo fail payment required",t.status),void o.reject(f.lV,h(t))):404===t.status?(a.P.log("qgApiHelper getJobInfo fail job not found",t.status),void o.reject(f.ZH)):(a.P.log("qgApiHelper getJobInfo fail connection problem",t.status),void o.reject(f.QG))})),o},v.prototype.getJobInfoUntilStatus=function(e,t,r,i){(0,n.A2)(e),(0,o.vV)(i)&&(i=!0),(0,o.uC)(r)||(r=5),(0,n.VW)(r),(0,n.GY)(r>0);var p=g.Deferred(),u=0,l=this;return function n(){if(u>r)return a.P.log("qgApiHelper getJobInfoUntilStatus fail - no more retries"),void p.reject(f.db);l.getJobInfo(e,i).done((function(e){if(e.status.code!==t){"init"===e.status.code&&200,u++,setTimeout(n,100)}else p.resolve(e)})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper getJobInfoWithRetries getJobInfo fail - payment required",e),void p.reject(f.lV,t);u++,setTimeout(n,2e3)}))}(),p},v.prototype.getJobInfoWithRetries=function(e,t){(0,n.A2)(e),(0,o.uC)(t)||(t=5),(0,n.VW)(t),(0,n.GY)(t>0);var r=g.Deferred(),i=0,p=this;return function n(){if(i>t)return a.P.log("qgApiHelper getJobInfoWithRetries fail - no more retries"),void r.reject(f.db);p.getJobInfo(e).done((function(e){r.resolve(e)})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper getJobInfoWithRetries getJobInfo fail - payment required"),void r.reject(f.lV,t);i++,setTimeout(n,2e3)}))}(),r},v.prototype.addInput=function(e,t){(0,n.A2)(e),(0,n.u)(t),(0,n.zr)(t),(0,n.gA)(t,"type");var r=this.api,i=g.Deferred(),o=g.extend({},r.baseAjaxOptions);o.url=this.baseUrlApi+"/api/jobs/"+e+"/input",o.data=t;return r.ajaxWrapper.postJson(o).done((function(e,t,r){var n=e=d(e);a.P.log("qgApiHelper addJobInput done",JSON.stringify(n)),i.resolve(n)})).fail((function(e,t,r){return 0===e.status?(a.P.log("qgApiHelper addJobInput fail connection problem",e.status),void i.reject(f.QG)):402===e.status?(a.P.log("qgApiHelper addJobInput fail payment required"),void i.reject(f.lV,h(e))):(a.P.log("qgApiHelper addJobInput fail connection problem",e.status),void i.reject(f.D$))})),i},v.prototype.addInputWithCheck=function(e,t,r){(0,n.A2)(e),(0,n.u)(t),(0,n.zr)(t),(0,n.gA)(t,"type"),(0,n.VW)(r),(0,n.GY)(r>=0);var i=g.Deferred(),o=0,p=this;function u(){if(o>5)return a.P.log("qgApiHelper addInputWithCheck fail - too many retries"),void i.reject(f.db);p.addInput(e,t).done((function(t){p.getJobInfoUntilInputCount(e,r+1).done((function(){i.resolve(t)})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper addInputWithCheck fail - payment required"),void i.reject(f.lV,t);a.P.log("qgApiHelper addInputWithCheck fail",e),i.reject(f.D$)}))})).fail((function(t,n){if(t!==f.QG){if(t===f.lV)return a.P.log("qgApiHelper addInputWithCheck fail - payment required"),void i.reject(f.lV,n);a.P.log("qgApiHelper addInputWithCheck fail"),i.reject(t)}else p.getJobInfoWithRetries(e,3).done((function(e){var t=e.input.length;return t===r?(a.P.log("qgApiHelper addInputWithCheck retry"),void setTimeout(u,2e3)):t===r+1?(a.P.log("qgApiHelper addInputWithCheck done - with retry"),void i.resolve(e.input[t-1])):(a.P.log("qgApiHelper addInputWithCheck fail","wrong number of inputs"),void i.reject(f.D$))})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper addInputWithCheck fail - payment required"),void i.reject(f.lV,t);a.P.log("qgApiHelper addInputWithCheck fail",e),i.reject(f.D$)}))})),o++}return u(),i},v.prototype.addInputs=function(e,t){(0,n.A2)(e),(0,n.u)(t);var r=this.api,i=g.Deferred(),p=g.extend({},r.baseAjaxOptions);p.url=this.baseUrlApi+"/api/jobs/"+e+"/input",p.data=t;return r.ajaxWrapper.postJson(p).done((function(e,r,n){var p=e=d(e);if(!new s((0,o.Hm)(p)?p[0]:p).isValid())return a.P.log("qgApiHelper addJobInput fail broken response",{info:"response: "+JSON.stringify(p)}),void i.reject(f.FK);a.P.log("qgApiHelper addJobInput done",JSON.stringify(t)),i.resolve(p)})).fail((function(e,t,r){if(402===e.status)return a.P.log("qgApiHelper addJobInput fail payment required"),void i.reject(f.lV,h(e));a.P.log("qgApiHelper addJobInput fail connection problem",e.status),i.reject(f.QG)})),i},v.prototype.addConversion=function(e,t){(0,n.A2)(e),(0,n.u)(t);var r=this.api,i=g.Deferred(),p=g.extend({},r.baseAjaxOptions);p.url=this.baseUrlApi+"/api/jobs/"+e+"/conversions",p.data=t;return r.ajaxWrapper.postJson(p).done((function(e,r,n){e=d(e),a.P.log("qgApiHelper addConversion done",JSON.stringify(t)),i.resolve(e)})).fail((function(e,t,r){var n=function(e){if(!(0,o.jV)(e))return null;if(!(0,o.jV)(e.responseJSON))return null;var t=e.responseJSON;return(0,o.fN)(t,"code")&&(0,o.fN)(t,"message")?{code:t.code,message:t.message}:null}(e);if(n){if(2===n.code)return a.P.log("qgApiHelper addConversion fail - invalid conversion option",{http_status:e.status,info:"conversion options: "+JSON.stringify(p)}),void i.reject(f.cM);if(2002===n.code)return a.P.log("qgApiHelper addConversion fail - job can not be modified",{http_status:e.status,info:"conversion options: "+JSON.stringify(p)}),void i.reject(f.$7)}return 0===e.status?(a.P.log("qgApiHelper addConversion fail - connection problem",e.status),void i.reject(f.QG)):402===e.status?(a.P.log("qgApiHelper addConversion fail - payment required"),void i.reject(f.lV,h(e))):(a.P.log("qgApiHelper addConversion fail - unknown",e.status),void i.reject(f.D$))})),i},v.prototype.addConversionWithCheck=function(e,t){(0,n.A2)(e);var r=g.Deferred(),i=this,p=0;function u(){if(p>5)return a.P.log("qgApiHelper addConversionWithCheck fail - too many retries"),void r.reject(f.db);i.addConversion(e,t).done((function(e){r.resolve(e)})).fail((function(t,n){if(t===f.lV)return a.P.log("qgApiHelper addConversionWithCheck fail - payment required"),void r.reject(f.lV,n);t===f.QG||t===f.D$?i.getJobInfoWithRetries(e,5).done((function(e){if((0,o.Hm)(e.conversion)){if(0===e.conversion.length)return a.P.log("qgApiHelper addConversionWithCheck retry - no conversion"),void setTimeout(u,2e3);if(1===e.conversion.length)return a.P.log("qgApiHelper addConversionWithCheck done - after fail"),void r.resolve(e.conversion[0]);a.P.log("qgApiHelper addConversionWithCheck fail - too many conversions"),r.reject(f.D$)}})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper addConversionWithCheck fail - payment required"),void r.reject(f.lV,t);a.P.log("qgApiHelper addConversionWithCheck fail - fail in getjobinfo"),r.reject(f.D$)})):r.reject(t)})),p++}return u(),r},v.prototype.startJob=function(e,t){(0,n.A2)(e);var r=g.Deferred();return r.reject(f.DC),r},v.prototype.deleteInput=function(e,t){(0,n.A2)(e),(0,n.A2)(t);var r=this.api,i=g.Deferred(),o=g.extend({},r.baseAjaxOptions);o.url=this.baseUrlApi+"/api/jobs/"+e+"/input/"+t+"/delete",o.data=g.extend({},r.baseData);return r.ajaxWrapper.postJson(o).done((function(e,r,n){e=d(e),a.P.log("qgApiHelper deleteInput done",t),i.resolve(e)})).fail((function(e,t,r){if(402===e.status)return a.P.log("qgApiHelper deleteInput fail payment required",e.status),void i.reject(f.lV,h(e));a.P.log("qgApiHelper deleteInput fail connection problem",e.status),i.reject(f.QG)})),i},v.prototype.deleteInputAndWait=function(e,t){var r=this;(0,n.A2)(e),(0,n.A2)(t);this.api;var i=g.Deferred();return this.deleteInput(e,t).done((function(){r.getJobInfoUntilInputIsDeleted(e,t).done((function(){i.resolve()})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper delete input and wait fail - payment required"),void i.reject(f.lV,t);a.P.log("qgApiHelper delete input and wait fail connection problem",e),i.reject(f.QG)}))})).fail((function(e,t){if(a.P.log("qgApiHelper delete input and wait fail connection problem",e),e===f.lV)return a.P.log("qgApiHelper addConversionWithCheck fail - payment required"),void i.reject(f.lV,t);i.reject(f.QG)})),i},v.prototype.setPassword=function(e,t,r){(0,n.A2)(e),(0,n.A2)(t);var i=g.Deferred(),o=this.api,p=this,u=0,l=g.extend({},o.baseData,{credentials:{decrypt_password:r}}),s=g.extend({},o.baseAjaxOptions);return s.url=this.baseUrlApi+"/api/jobs/"+e+"/input/"+t+"/patch",s.data=l,this.getJobInfoUntilInput(e,t).done((function(r){u=r.modified_at,o.ajaxWrapper.postJson(s).done((function(r,n,o){r=d(r),a.P.log("qgApiHelper set password done",t),p.getUpdatedInput(e,t,u).done((function(e){a.P.log("qgApiHelper set password finished",t),i.resolve(e)})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper set password fail  payment required"),void i.reject(f.lV,t);a.P.log("qgApiHelper set password fail connection problem",e),i.reject(f.QG)}))})).fail((function(e,t,r){if(402===e.status)return a.P.log("qgApiHelper set password fail payment required",e.status),void i.reject(f.lV,h(e));a.P.log("qgApiHelper set password fail connection problem",e.status),i.reject(f.QG)}))})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper set password fail  payment required"),void i.reject(f.lV,t);a.P.log("qgApiHelper set password fail connection problem",e),i.reject(f.QG)})),i},v.prototype.getJobInfoUntilInput=function(e,t){var r=g.Deferred(),n=this,i=0;return function o(){n.getJobInfo(e).done((function(e){var n=e.input.find((function(e,r,n){return e.id===t}));void 0===n?(i>60&&r.reject(f.db),++i,setTimeout(o,1e3)):r.resolve(n)})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper getJobInfoUntilInput fail  payment required"),void r.reject(f.lV,t);a.P.log("qgApiHelper getJobInfoUntilInput fail connection problem",e),r.reject(f.QG)}))}(),r},v.prototype.getJobInfoUntilInputIsDeleted=function(e,t){var r=g.Deferred(),n=this,i=0;return function o(){n.getJobInfo(e).done((function(e){void 0!==e.input.find((function(e,r,n){return e.id===t}))?(i>60&&r.reject(f.db),++i,setTimeout(o,1e3)):r.resolve()})).fail((function(e,t){a.P.log("qgApiHelper getJobInfoUntilInputIsDeleted connection problem",e),r.reject(f.QG)}))}(),r},v.prototype.getJobInfoUntilInputCount=function(e,t){var r=g.Deferred(),n=this,i=0,o=0;return function p(){n.getJobInfo(e).done((function(e){o=0,e.input.length>=t?r.resolve(e):i>60?r.reject(f.db):(++i,setTimeout(p,1e3))})).fail((function(e,t){return e===f.lV?(a.P.log("qgApiHelper getJobInfoUntilInputCount fail payment required"),void r.reject(f.lV,t)):o<30?(o++,void setTimeout(p,3e3)):(a.P.log("qgApiHelper getJobInfoUntilInputCount fail",e),void r.reject(f.QG))}))}(),r},v.prototype.getJobInfoUntilAtLeastOneInput=function(e){var t=g.Deferred(),r=this,n=0;return function i(){r.getJobInfo(e).done((function(e){e.input.length>=1?t.resolve(e):n>60?t.reject(f.db):(++n,setTimeout(i,1e3))})).fail((function(e,r){if(e===f.lV)return a.P.log("qgApiHelper getJobInfoUntilAtLeastOneInput fail payment required"),void t.reject(f.lV,r);a.P.log("qgApiHelper getJobInfoUntilAtLeastOneInput fail",e),t.reject(f.QG)}))}(),t},v.prototype.getUpdatedInput=function(e,t,r){var n=g.Deferred(),i=this,o=0;return function p(){i.getJobInfo(e).done((function(e){var i=e.input.find((function(e,r,n){return e.id===t}));i.modified_at>r?n.resolve(i):o>60?n.reject(f.db):(++o,setTimeout(p,1e3))})).fail((function(e,t){if(e===f.lV)return a.P.log("qgApiHelper get updated input fail payment required"),void n.reject(f.lV,t);a.P.log("qgApiHelper get updated input fail connection problem",e),n.reject(f.QG)}))}(),n};var b=r(27489);function A(e){(0,n.VW)(e),this.maxCacheTimeSeconds=e,this.data={}}A.prototype.setData=function(e,t){(0,n.LJ)(e),(0,n.kM)(t),(0,n.mR)(t),this.data[e]={time_ms:Date.now(),data:t}},A.prototype.getData=function(e){return(0,n.LJ)(e),this.data.hasOwnProperty(e)?!((Date.now()-this.data[e].time_ms)/1e3>this.maxCacheTimeSeconds)&&this.data[e].data:null},A.prototype.getDataEvenIfTooOld=function(e){return(0,n.LJ)(e),this.data.hasOwnProperty(e)?this.data[e].data:null};var I=r(17105),j=r(19755);function y(e){(0,o.vV)(e)&&(e={}),this.baseApiData=null,(0,o.jV)(e.baseApiData)&&(this.baseApiData=e.baseApiData),this.baseUrlApi=null,(0,o.Rt)(e.baseUrlApi)&&(this.baseUrlApi=e.baseUrlApi),this.paymentRequiredCallback=null,(0,o.Cj)(e.paymentRequiredCallback)&&(this.paymentRequiredCallback=e.paymentRequiredCallback)}function q(e,t){(0,n.LJ)(e),this.apiHelper=new v(this,t),(0,n.kM)(this.apiHelper,'type must be "sat" or "oc"'),this.ajaxWrapper=new b.F,this.jobCache=new A(2),this.numberOfCurrentJobInfoRequests={},this.baseData={},(0,o.jV)(t.baseApiData)&&(this.baseData=t.baseApiData),this.baseAjaxOptions={dataType:"json",crossDomain:!0,xhrFields:{withCredentials:!0},cache:!1,maxRetries:3,retryTimeout:!0,retry400:!1,retry500:!0,retryOther:!0}}q.prototype.createJob=function(e){var t=this.apiHelper;try{return t.createJob(e)}catch(e){a.P.log("qgApiHelper exception",e)}var r=j.Deferred();return r.reject(f.hI),r},q.prototype.createJobWithUploadServerCheck=function(e,t){(0,o.uC)(t)||(t=1);var r=j.Deferred(),n=this,i=0;function p(){n.apiHelper.createJob(e).done((function(e){!function(e){n.checkUploadServer(e.server).done((function(){var t=!0;r.resolve(e,t)})).fail((function(n,o){if(n!==f.lV)if(i>=t){a.P.log("qgApiHelper createJob info","no upload server found");var u=!1;r.resolve(e,u)}else{var l=1e4,s=1e3*++i;s>l&&(s=l),setTimeout((function(){p()}),s)}else r.reject(f.lV,o)}))}(e)})).fail((function(e,t){(0,I.T)(e),r.reject(e,t)}))}return p(),r},q.prototype.checkUploadServer=function(e,t){(0,n.LJ)(e),(0,o.uC)(t)||(t=0);e.replace(/(\/dl.*)/,"/dl/alive"),Date.now();var r=j.Deferred();return r.resolve()},q.prototype.getJobInfo=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];(0,n.A2)(e);var i=this.apiHelper;try{return i.getJobInfo(e,t,r)}catch(e){a.P.log("qgApiHelper exception",e)}var o=j.Deferred();return o.reject(f.hI),o},q.prototype.getJobInfoUntilStatus=function(e,t,r,i){(0,n.A2)(e);var o=this.apiHelper;try{return o.getJobInfoUntilStatus(e,t,r,i)}catch(e){a.P.log("qgApiHelper exception",e)}var p=j.Deferred();return p.reject(f.hI),p},q.prototype.getJobInfoWithRetries=function(e,t){(0,n.A2)(e),(0,o.uC)(t)||(t=5),(0,n.VW)(t),(0,n.GY)(t>0);var r=this.apiHelper;try{return r.getJobInfoWithRetries(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.getCachedJobInfo=function(e){(0,n.A2)(e);var t=this.jobCache.getData(e);(0,n.kM)(t),this.numberOfCurrentJobInfoRequests.hasOwnProperty(e)||(this.numberOfCurrentJobInfoRequests[e]=0);var r=this.numberOfCurrentJobInfoRequests[e]>0;if(!1===t&&!r)return this.getJobInfo(e);var i=this.jobCache.getDataEvenIfTooOld(e),o=j.Deferred();return o.resolve(i),o},q.prototype.addInput=function(e,t){(0,n.A2)(e),(0,n.u)(t);var r=this.apiHelper;try{return r.addInput(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.addInputWithCheck=function(e,t,r){(0,n.A2)(e),(0,n.u)(t),(0,n.VW)(r),(0,n.GY)(r>=0);var i=this.apiHelper;try{return i.addInputWithCheck(e,t,r)}catch(e){a.P.log("qgApiHelper exception",e)}var o=j.Deferred();return o.reject(f.hI),o},q.prototype.addInputsWithCheck=function(e,t,r){(0,n.A2)(e),(0,n.bG)(t),(0,n.GY)(t.length>0),(0,n.VW)(r),(0,n.GY)(r>=0);this.apiHelper;var i=this,o=j.Deferred(),p=0,u=t.length,l=r;return function r(){i.addInputWithCheck(e,t[p],l).done((function(){p++,l++,p>=u?o.resolve():setTimeout(r,200)})).fail((function(e,t){a.P.log("qgApiHelper addInputsWithCheck fail",e),o.reject(e,t)}))}(),o},q.prototype.addInputs=function(e,t){(0,n.A2)(e);var r=this.apiHelper;try{return r.addInputs(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.addInputId=function(e,t){(0,n.A2)(e),(0,n.A2)(t);var r={type:"input_id",source:t};return this.addInput(e,r)},q.prototype.addExternalUrl=function(e,t,r){(0,n.A2)(e),(0,n.LJ)(t),(0,o.vV)(r)&&(r="auto");var i={type:"remote",source:t,engine:r};return this.addInput(e,i)},q.prototype.addConversion=function(e,t){(0,n.A2)(e);var r=this.apiHelper;try{return r.addConversion(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.addConversionWithCheck=function(e,t){(0,n.A2)(e);var r=this.apiHelper;try{return r.addConversionWithCheck(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.startJob=function(e,t){(0,n.A2)(e);var r=this.apiHelper;try{return r.startJob(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.deleteInput=function(e,t){(0,n.A2)(e),(0,n.A2)(t);var r=this.apiHelper;try{return r.deleteInput(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.deleteInputAndWait=function(e,t){(0,n.A2)(e),(0,n.A2)(t);var r=this.apiHelper;try{return r.deleteInputAndWait(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.setPassword=function(e,t,r){(0,n.A2)(e),(0,n.A2)(t),(0,n.pX)(r);var i=this.apiHelper;try{return i.setPassword(e,t,r)}catch(e){a.P.log("qgApiHelper exception",e)}var o=j.Deferred();return o.reject(f.hI),o},q.prototype.getJobInfoUntilInputCount=function(e,t){(0,n.A2)(e);var r=this.apiHelper;try{return r.getJobInfoUntilInputCount(e,t)}catch(e){a.P.log("qgApiHelper exception",e)}var i=j.Deferred();return i.reject(f.hI),i},q.prototype.getJobInfoUntilAtLeastOneInput=function(e){(0,n.A2)(e);var t=this.apiHelper;try{return t.getJobInfoUntilAtLeastOneInput(e)}catch(e){a.P.log("qgApiHelper exception",e)}var r=j.Deferred();return r.reject(f.hI),r},q.prototype.waitForRemoteInput=function(e,t){(0,n.A2)(e),(0,n.A2)(t);var r=this,o=j.Deferred(),u=Date.now();function s(){var e=(Date.now()-u)/1e3,t=5e3;e<10?t=1e3:e<30?t=2e3:e<60&&(t=3e3),setTimeout(c,t)}function d(r){var n=(Date.now()-u)/1e3,i=new p.S(r),d=i.getInput(t);if(null===d)return n>10&&a.P.log("qgApiHelper waitForRemoteInput info",{info:"input id missing from job",input_id:t,job_id:e,job_info:JSON.stringify(r),duration_s:n}),void s();if(i.isInputDownloading(t))s();else{if(i.isInputReady(t))return o.resolve(d),void a.P.log("qgApiHelper waitForRemoteInput done",{input_id:t,job_id:e,duration_s:n});var c={code:0,message:"should never happen"},g=i.getInputError(t),h=i.getInputWarning(t);null!==g?c=g:null!==h?c=h:d.status===l.V5?c={code:0,message:"server response is missing input warnings and input errrors"}:d.status===l.s8&&(c={code:0,message:"input was canceled"});var v=function(r,n,i){a.P.log("qgApiHelper waitForRemoteInput fail",{info:JSON.stringify(r),input_id:t,job_id:e,job_info:JSON.stringify(n),duration_s:i});var o=f.D$;return 50===r.code||34===r.code?o=f.sZ:10===r.code&&(o=f.u7),(0,I.T)(o),o}(c,r,n);(0,I.T)(v),o.reject(v)}}function c(){r.getCachedJobInfo(e).done((function(e){(0,i.dI)(e),d(e)})).fail((function(r,n){(0,I.T)(r),r!==f.lV?(a.P.log("qgApiHelper waitForRemoteInput retry",{info:"error: "+r,job_id:e,input_id:t}),s()):o.reject(r,n)}))}return c(),o},q.prototype.savePreset=function(e){var t=this.apiHelper;try{return t.savePreset(e)}catch(e){a.P.log("qgApiHelper exception",e)}var r=j.Deferred();return r.reject(f.hI),r},q.prototype.waitForCompletedJob=function(e){var t=j.Deferred(),r=Date.now(),n=0;var i=this;return function o(){n>5?t.reject(f.db):i.getJobInfoWithRetries(e,3).done((function(n){var i=Date.now()-r,p=n.status.code;if("completed"!==p){if("failed"===p)return a.P.log("qgApiHelper waitForCompletedJob - job is failed",{job_id:e}),void t.reject(f.rt);if(("incomplete"===p||"ready"===p)&&i>4e3)return a.P.log("qgApiHelper waitForCompletedJob - job has unextected status",{job_id:e,info:"status: "+p}),void t.reject(f.rt);var u=function(e){var t=500;return e>2e3&&(t=1e3),e>5e3&&(t=2e3),e>1e4&&(t=3e3),t}(i);setTimeout(o,u)}else t.resolve(n)})).fail((function(e,r){e!==f.lV?(n++,setTimeout(o,5e3)):t.reject(f.lV,r)}))}(),t},q.prototype.createJobAndConversion=function(e,t){var r=j.Deferred(),n=this;return this.createJob(e).done((function(e){n.addConversionWithCheck(e.id,t).done((function(t){r.resolve(e)})).fail((function(e,t){e!==f.lV?r.reject(f.D$,t):r.reject(f.lV,t)}))})).fail((function(e,t){e!==f.lV?r.reject(f.D$,t):r.reject(f.lV,t)})),r},q.prototype.createThumbnailFromInputId=function(e,t){var r=j.Deferred();(0,o.vV)(t)&&(t=200);var n={category:"operation",target:"thumbnail",options:{thumbnail_target:"jpg",width:t,allow_multiple_outputs:!0,pages:"1"}},i=this;return this.createJobAndConversion({operation:"thumbnail system"},n).done((function(t){i.addInputId(t.id,e).done((function(e){i.waitForCompletedJob(t.id).done((function(e){r.resolve(e.output[0].uri)})).fail((function(e,t){e!==f.lV?r.reject(f.D$):r.reject(f.lV,t)}))})).fail((function(e,t){e!==f.lV?r.reject(f.D$):r.reject(f.lV,t)}))})).fail((function(e,t){e!==f.lV?r.reject(f.D$):r.reject(f.lV,t)})),r};var m=function(e){return(0,n.u)(e),new q("sat",e)}}}]);